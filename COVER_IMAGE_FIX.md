# 文章封面图片显示功能修复

## 问题描述

之前上传了文章封面，但在各个页面都没有展示封面图片。

## 修复内容

### 1. 首页文章列表 (Home.vue)

**修改内容**:
- ✅ 添加封面图片显示在文章卡片左侧
- ✅ 封面尺寸: 200x150px
- ✅ 支持图片预览（点击查看大图）
- ✅ 图片加载失败时显示占位符
- ✅ 卡片布局改为横向排列（封面+内容）

**显示效果**:
```
┌─────────────────────────────────────────┐
│ ┌────────┐  标题                         │
│ │        │  分类 标签                     │
│ │ 封面   │  摘要内容...                   │
│ │ 图片   │  作者 · 浏览量 · 日期         │
│ └────────┘                               │
└─────────────────────────────────────────┘
```

### 2. 文章详情页 (ArticleDetail.vue)

**修改内容**:
- ✅ 在标题和内容之间显示封面图片
- ✅ 封面宽度100%，最大高度500px
- ✅ 支持点击预览大图
- ✅ 图片加载失败时显示错误提示
- ✅ 添加圆角和阴影效果

**显示效果**:
```
标题
作者 · 日期 · 浏览量 · 分类 · 标签
─────────────────────────────────
┌─────────────────────────────┐
│                             │
│      封面图片（大图）         │
│                             │
└─────────────────────────────┘
文章内容...
```

### 3. 我的文章列表 (MyArticles.vue)

**修改内容**:
- ✅ 在表格第一列添加封面缩略图
- ✅ 缩略图尺寸: 80x60px
- ✅ 支持点击预览大图
- ✅ 无封面时显示"无封面"文字
- ✅ 图片加载失败时显示图标占位符

**显示效果**:
```
┌────────┬────────┬──────┬──────┬────────┬──────┐
│  封面  │  标题  │ 分类 │ 标签 │  状态  │ 操作 │
├────────┼────────┼──────┼──────┼────────┼──────┤
│ [图片] │ 标题1  │ 分类 │ 标签 │ 已发布 │ 按钮 │
│ 无封面 │ 标题2  │ 分类 │ 标签 │ 草稿   │ 按钮 │
└────────┴────────┴──────┴──────┴────────┴──────┘
```

## 技术实现

### 封面URL处理

在所有页面中添加了 `getCoverImageUrl` 函数：

```javascript
const getCoverImageUrl = (url) => {
  if (!url) return ''
  // 如果是相对路径，添加完整的URL
  if (url.startsWith('/uploads')) {
    return `http://localhost:8080${url}`
  }
  return url
}
```

### 响应式图片

使用 Element Plus 的 `el-image` 组件：
- 自动适配容器大小
- 支持预览功能
- 错误处理和占位符
- 懒加载优化

### 样式优化

**首页文章卡片**:
- 使用 Flexbox 横向布局
- 封面固定宽度，内容自适应
- 悬停效果和过渡动画

**文章详情页**:
- 居中显示
- 最大高度限制，保持比例
- 圆角和阴影效果

**我的文章表格**:
- 固定尺寸缩略图
- 表格列宽优化
- 点击预览支持

## 修改的文件

1. **frontend/src/views/Home.vue**
   - 添加封面图片显示
   - 优化卡片布局
   - 添加 getCoverImageUrl 函数

2. **frontend/src/views/ArticleDetail.vue**
   - 在内容前显示封面
   - 添加图片预览功能
   - 添加 getCoverImageUrl 函数

3. **frontend/src/views/MyArticles.vue**
   - 添加封面列
   - 显示缩略图
   - 添加 getCoverImageUrl 函数

## 使用说明

### 上传封面后的显示

1. **首页**: 
   - 有封面的文章会在左侧显示200x150px的封面图
   - 无封面的文章正常显示（无封面区域）

2. **文章详情**:
   - 有封面会在标题下方显示大图
   - 无封面则直接显示文章内容

3. **我的文章**:
   - 封面列会显示80x60px的缩略图
   - 无封面显示"无封面"文字

### 预览功能

所有封面图片都支持点击预览：
- 点击图片弹出大图预览
- ESC 或点击遮罩关闭预览
- 支持图片缩放

## 测试步骤

1. **创建带封面的文章**:
   ```
   1. 登录系统
   2. 创建新文章
   3. 上传封面图片
   4. 保存并发布
   ```

2. **查看首页**:
   ```
   1. 访问首页
   2. 确认文章卡片左侧显示封面
   3. 点击封面预览大图
   ```

3. **查看文章详情**:
   ```
   1. 点击文章进入详情页
   2. 确认标题下方显示封面大图
   3. 测试预览功能
   ```

4. **查看我的文章**:
   ```
   1. 进入"我的文章"页面
   2. 确认封面列显示缩略图
   3. 点击缩略图预览
   ```

## 注意事项

### 开发环境

当前使用的是硬编码的后端地址：`http://localhost:8080`

### 生产环境部署

部署到生产环境时，需要修改以下文件中的URL：

**Home.vue**:
```javascript
const getCoverImageUrl = (url) => {
  if (!url) return ''
  if (url.startsWith('/uploads')) {
    return `https://your-domain.com${url}` // 修改为生产环境URL
  }
  return url
}
```

**ArticleDetail.vue** 和 **MyArticles.vue** 中做同样修改。

或者更好的做法是：

1. **创建配置文件** `frontend/src/config.js`:
```javascript
export const API_BASE_URL = import.meta.env.VITE_API_URL || 'http://localhost:8080'
```

2. **在 `.env` 文件中配置**:
```
VITE_API_URL=http://localhost:8080
```

3. **在组件中使用**:
```javascript
import { API_BASE_URL } from '@/config'

const getCoverImageUrl = (url) => {
  if (!url) return ''
  if (url.startsWith('/uploads')) {
    return `${API_BASE_URL}${url}`
  }
  return url
}
```

## 后续优化建议

1. **统一URL处理**:
   - 创建全局的图片URL处理工具函数
   - 避免在多个组件中重复代码

2. **图片懒加载**:
   - 首页文章列表较多时使用懒加载
   - 提升页面加载性能

3. **默认封面**:
   - 为无封面文章提供默认封面图
   - 提升视觉一致性

4. **封面裁剪**:
   - 上传时提供裁剪功能
   - 确保封面比例统一

5. **CDN支持**:
   - 封面图片使用CDN加速
   - 提升加载速度

## 总结

✅ **修复完成**: 文章封面现在可以在所有相关页面正常显示
✅ **用户体验**: 支持预览、错误处理、响应式布局
✅ **代码质量**: 统一的URL处理、良好的样式设计

封面图片功能已完全可用，用户上传的封面会在首页、详情页和文章管理页面正确展示。



